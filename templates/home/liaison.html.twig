{% extends 'base.html.twig' %} {% block title %}Accueil{% endblock %} {% block
  body %}

  <main id="main" class="main">
    <div class="pagetitle">
      <nav>
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="index.html">Home</a></li>
          <li class="breadcrumb-item active">Liaison</li>
        </ol>
      </nav>
    </div>
    <!-- End Page Title -->

    <section class="section dashboard">
      <div class="row">
        <!-- Left side columns -->
        <div class="col-lg-12">
          <div class="row">



            <!-- Reports -->
            <div class="col-12">
              <div class="card">
                <div class="filter">
                  <a class="icon" href="#" data-bs-toggle="dropdown"
                  ><i class="bi bi-three-dots"></i
                    ></a>
                  <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                    <li class="dropdown-header text-start">
                      <h6>Filter</h6>
                    </li>

                    <li><a class="dropdown-item" href="#">Today</a></li>
                    <li><a class="dropdown-item" href="#">This Month</a></li>
                    <li><a class="dropdown-item" href="#">This Year</a></li>
                  </ul>
                </div>

                <div class="card-body">
                  <h5 class="card-title">Forrmulaire de liaison</h5>
                  {{ form_start(form, {'attr': {'id': 'liaisonForm'}}) }}
                  {{ form_row(form.contratid) }}
                  {{ form_row(form.telephoneid) }}
                  {{ form_row(form.create) }}
                  {{ form_end(form) }}
                  <script>
                    $(document).ready(function() {
                      $('#liaisonForm').submit(function (e) {
                        e.preventDefault();
                        $.ajax({
                          url: $(this).attr('action'),
                          type: $(this).attr('method'),
                          data: $(this).serialize(),
                          success: function(response) {
                            var newLine = '<tr>' +
                                    '<td style="background: #a0bbf18f">' + response.data.contratid.reference + '</td>' +
                                    '<td style="background: #a0bbf18f">' + response.data.contratid.customerid.name + '</td>' +
                                    '<td style="background: #a0bbf18f">' + response.data.telephoneid.name + '</td>' +
                                    '</tr>';

                            // Insérer la nouvelle ligne en première position du tbody
                            $('.datatable tbody').prepend(newLine);
                          },
                          error: function(xhr) {
                            // Gérer les erreurs
                          }
                        });
                      });
                    });
                  </script>
                  <!-- Line Chart -->
                  <div id="reportsChart"></div>

                </div>
              </div>
            </div>
            <!-- End Reports -->
            <section class="section">
              <div class="row">
                <div class="col-lg-12">
                  <div class="card">
                    <div class="card-body">
                      <h5 class="card-title">Liaison</h5>

                      <!-- Table with stripped rows -->
                      <table class="table datatable">
                        <thead>
                        <tr>
                          <th scope="col">Reférence</th>
                          <th scope="col">Nom</th>

                          <th scope="col">Télphone</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for control in controls %}
                          <tr>
                            <td>
                              {{ control.contratid.reference }}
                            </td>
                            <td>
                              {{ control.contratid.customerid.name }}
                            </td>
                            <td class="d-none">{{  control.telephoneid.name }}</td>


                          </tr>
                        {% endfor %}
                        </tbody>
                      </table>
                      <!-- End Table with stripped rows -->
                    </div>
                  </div>
                </div>
              </div>
            </section>
          </div>
        </div>
        <!-- End Left side columns -->

      </div>
    </section>
  </main>
  <!-- End #main -->


  {#
  <main id="main" class="main">
    <div class="pagetitle">
      <h1>Contrats</h1>
      <nav>
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="index.html">Home</a></li>
          <li class="breadcrumb-item">Pages</li>
          <li class="breadcrumb-item active">Contact</li>
        </ol>
      </nav>
    </div>
    <!-- End Page Title -->
  </main>
  #} {% endblock %}
